<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Sirtec Doc Flow</title>
      
    <link rel="icon" href="../static/logo.ico" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css">
    <script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">
    <link rel="stylesheet" href="https://rawcdn.githack.com/Loopple/loopple-public-assets/ad60f16c8a16d1dcad75e176c00d7f9e69320cd4/argon-dashboard/css/nucleo/css/nucleo.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.4/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10/dist/sweetalert2.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='theme_home.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='loopple_pdf.css') }}">
    <link rel="stylesheet" href="../static/loopple_pdf.css">
    <link rel="stylesheet" href="../static/theme_home.css">
    

    
  </head>
  
  <body class="g-sidenav-show">
    <nav class="sidenav navbar navbar-vertical fixed-left navbar-expand-xs navbar-light bg-white loopple-fixed-start" id="sidenav-main">
        <nav class="sidenav navbar navbar-vertical fixed-left navbar-expand-xs navbar-light bg-white" id="sidenav-main">
            <div class="sidenav-header  align-items-center"> <a class="navbar-brand"> <img src="https://sirtec.com.br/restrito/logo.png" class="navbar-brand-img"> Sirtec Doc Flow</a> </div>
            <hr class="mt-0 mb-3">
            <div class="d-flex align-items-center"> <img src="https://static.vecteezy.com/ti/vetor-gratis/p1/7407996-user-icon-person-icon-client-symbol-login-head-sign-icon-design-vetor.jpg" class="avatar ml-3">
                <div class="ml-3">
                    <h4 class="mb-0">{{session['username']}}</h4>
                    <p class="text-xs mb-0">{{session['office']}}</p>
                </div>
            </div>
            <hr class="mt-3 mb-0">
            <div class="navbar-inner">
                <div class="collapse navbar-collapse" id="sidenav-collapse-main">
                    <ul class="navbar-nav">
                        <li class="nav-item"> <a class="nav-link {% if active_page == 'admin.admin' %}active{% endif %}" href="{{ url_for('admin.admin') }}"> <i class="fa fa-desktop text-primary"></i> <span class="nav-link-text">Home</span> </a> </li>
                        <li class="nav-item"> <a class="nav-link {% if active_page == 'pdf.pdf' %}active{% endif %}" href="{{ url_for('pdf.pdf') }}"> <i class="fa fa-file-pdf text-info"></i> <span class="nav-link-text">PDF</span> </a> </li>
                        <li class="nav-item"> <a class="nav-link {% if active_page == 'usuarios.usuarios' %}active{% endif %}" href="{{ url_for('usuarios.usuarios') }}"> <i class="fa fa-address-book "></i> <span class="nav-link-text">Usuários</span> </a> </li>
                        <li class="nav-item"> <a class="nav-link {% if active_page == 'old_files.old_files' %}active{% endif %}" href="{{ url_for('old_files.old_files') }}"><i class="fa fa-bookmark text-success"></i> <span class="nav-link-text">Documentos Antigos</span> </a> </li>
                        <li class="nav-item"> <a class="nav-link" href="javascript:"> <i class="fa fa-cog text-dark"></i> <span class="nav-link-text">Configurações</span> </a> </li>
                    </ul>
                </div>
                <div class="bg-gradient-primary card position-fixed bottom-0">
                </div>
            </div>
        </nav>
    </nav>
    <div class="main-content" id="panel">
        <nav class="navbar navbar-top navbar-expand navbar-dark bg-primary border-bottom" id="navbarTop">
            <div class="container-fluid">
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav align-items-center  ml-md-auto ">
                        <li class="nav-item d-xl-none">
                            <div class="pr-3 sidenav-toggler sidenav-toggler-dark active" data-action="sidenav-pin" data-target="#sidenav-main">
                                <div class="sidenav-toggler-inner"> <i class="sidenav-toggler-line"></i> <i class="sidenav-toggler-line"></i> <i class="sidenav-toggler-line"></i> </div>
                            </div>
                        </li>
                        <li class="nav-item d-sm-none"> <a class="nav-link" href="#" data-action="search-show" data-target="#navbar-search-main"> <i class="ni ni-zoom-split-in"></i> </a> </li>
                        <li class="nav-item dropdown"> <a class="nav-link" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="fa fa-layer-group"></i> </a>
                            <div class="dropdown-menu dropdown-menu-lg dropdown-menu-dark bg-default  dropdown-menu-right ">
                                <div class="row shortcuts px-4"> 
                                  <a href="https://sirtec.desk.ms/?Portal#Home" class="col-4 shortcut-item text-center"> 
                                      <span class="shortcut-media avatar rounded-circle bg-gradient-info "> 
                                          <i class="fa fa-book" aria-hidden="true"></i> 
                                      </span> 
                                      <small class="text-white">DeskManager</small> 
                                  </a> 
                                  <a href="https://autenticacao.allstrategy.com.br" class="col-4 shortcut-item text-center"> 
                                      <span class="shortcut-media avatar rounded-circle bg-gradient-red"> 
                                          <i class="fa fa-university"></i> 
                                      </span> 
                                      <small class="text-white">Plano</small> 
                                  </a> 
                                  <a href="https://sirtec.com.br/ti/index.php" class="col-4 shortcut-item text-center"> 
                                      <span class="shortcut-media avatar rounded-circle bg-gradient-orange"> 
                                          <i class="fa fa-users"></i> 
                                      </span> 
                                      <small class="text-white">Meu RH</small> 
                                  </a> 
                            </div>
                        </li>
                            <div class="dropdown-menu dropdown-menu-right dropdown-menu-xl py-0 overflow-hidden">
                                <div class="list-group list-group-flush"> 
                                    <a href="#!" class="list-group-item list-group-item-action">
                                        <div class="row align-items-center">
                                            <div class="col-auto">
                                                <!-- Avatar --> <img alt="Image placeholder" src="https://cdn-icons-png.flaticon.com/256/5146/5146077.png" class="avatar rounded-circle"> </div>
                                        </div>
                                    </a> 
                                </div>
                            </div>
                        </li>
                    </ul>
                    <ul class="navbar-nav align-items-center  ml-auto ml-md-0 ">
                        <li class="nav-item dropdown"> <a class="nav-link pr-0" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="media align-items-center"> <span class="avatar avatar-sm"> <img alt="Image placeholder" src="https://static.vecteezy.com/ti/vetor-gratis/p1/7407996-user-icon-person-icon-client-symbol-login-head-sign-icon-design-vetor.jpg"> </span> </div>
                            </a>
                            <div class="dropdown-menu  dropdown-menu-right ">
                                <div class="dropdown-header noti-title">
                                    <h6 class="text-overflow m-0">Bem vindo!</h6>
                                </div> 
                                <a href="#!" class="dropdown-item"> <i class="fa fa-user"></i> <span>Meu perfil</span> </a> 
                                <a href="#!" class="dropdown-item" onclick="logout()"> <i class="fa fa-sign-out-alt"></i> <span>Sair</span> </a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="container-fluid pt-3">
            <div class="row removable">
                <div class="col-lg-12 px-sm-0">
                    <div class="card shadow-none px-0 bg-transparent mt-0 mb-4">
                        <div class="card-body px-0 pb-0">
                            <div class="px-0 pb-4">
                                <div class="row flex-row">
                                    <div class="col-lg-12">
                                        <div class="card max-height-vh-70" style="max-height: 70vh;">
                                            <div class="card-header shadow-xl">
                                              <h2 class="text-center">Lista de usuários cadastrados</h2>
                                            </div>
                                            <br>
                                            <form class="navbar-search navbar-search-dark form-inline ml-auto mb-0" id="navbar-search-main">
                                                <button type="button" class="close align-items-center" data-action="search-close" data-target="#navbar-search-main" aria-label="Close">
                                                    <span aria-hidden="true">×</span>
                                                </button>
                                                <br>
                                                <br>
                                                <div class="form-group mb-0">
                                                    <div class="input-group input-group input-group-merge">
                                                        <input class="form-control ml-2" id="searchInput" placeholder="Buscar" type="text">
                                                        <div class="input-group-append mr-2">
                                                            <span class="input-group-text"><i class="fas fa-search"></i></span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                            <br>
                                            <button type="button" class="botao" data-toggle="modal" data-target="#insert">
                                                Adicionar novo usuário
                                            </button>
                                            <div class="card-body overflow-auto overflow-x-hidden">
                                                
                                                <div class="row justify-content-start mb-8">
                                                    
                                                    <table id="myTable" class="table align-items-center">
                                                        <thead>
                                                            <tr>
                                                                <th style="display: none;">#</th>
                                                                <th>Nome</th>
                                                                <th>Cargo</th>
                                                                <th>Role</th>
                                                                <th>Último acesso</th>
                                                                <th>Ações
                                                                    <button type="button" class="botao-export" onclick="exportToExcel()">
                                                                        <i class="fa fa-table"></i>
                                                                        <span class="texto-hover">Exportar usuários</span>
                                                                    </button>
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            {% for dado in dados %}
                                                                <tr>
                                                                    <td style="display: none;">{{ dado.id_user }}</td>
                                                                    <td>{{ dado.account }}</td>
                                                                    <td>{{ dado.office }}</td>
                                                                    <td>{{ dado.role }}</td>
                                                                    <td>{{ dado.access }}</td>
                                                                    <td>
                                                                        <button type="button" class="botao-edit" data-toggle="modal" data-target="#editModal" data-id_user="{{ dado.id_user }}" data-name="{{ dado.account }}" data-office="{{ dado.office }}" data-role="{{ dado.role}}" data-password="{{ dado.password }}">
                                                                            Editar
                                                                        </button>
                                                                        <button type="button" class="botao-delete" data-toggle="modal" data-target="#deleteModal" data-id_user="{{ dado.id_user }}" data-name="{{ dado.account }}">
                                                                            Excluir
                                                                        </button>
                                                                    </td>
                                                                </tr>
                                                            {% endfor %}
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> 

        <!-- Modal para adicionar informações -->
        <div class="modal" id="insert" role="dialog">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content modais">

                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h4 class="modal-title text">Adicionar Item</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <!-- Modal Body -->
                    <div class="modal-body">
                        <!-- Formulário para adicionar informações -->
                        <form id="addForm" method="post" action="{{ url_for('generateuser.generateuser') }}">
                            <div class="form-group">
                                <label for="nome" class="text">Nome:</label>
                                <input type="text" class="form-control" id="nome" name="nome" required>
                            </div>
                            <div class="form-group">
                                <label for="nome" class="text">Cargo:</label>
                                <input type="text" class="form-control" id="cargo" name="cargo" required>
                            </div>
                            <div class="form-group">
                                <label for="categoria" class="text">Role:</label>
                                <select class="form-control" id="categoria" name="role" required>
                                    <option value="admin">Administrador</option>
                                    <option value="user">Usuário padrão</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="senha" class="text">Senha:</label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="senha" name="senha" required>
                                    <div class="input-group-append">
                                        <button class="btn btn-primary" type="button" id="toggleSenha">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <div class="input-group-append">
                                        <!-- Botão para abrir modal de gerar senha -->
                                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#senhaModal">
                                            <i class="fas fa-key"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Modal Footer -->
                            <div class="modal-footer">
                                <button type="submit" class="btn btn-success">Enviar</button>
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal para gerar senhas aleatórias -->
        <div class="modal" id="senhaModal" role="dialog" style="z-index: 2000!important;">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content modais">
                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h4 class="modal-title text">Gerar Senha Aleatória</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <!-- Modal Body -->
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="senhaAleatoria" class="text">Senha Aleatória:</label>
                            <input type="text" class="form-control" id="senhaAleatoria" readonly>
                        </div>
                    </div>
                    <!-- Modal Footer -->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="gerarNovaSenha">Gerar Nova Senha</button>
                        <button type="button" class="btn btn-success" id="usarSenha">Usar Senha</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal para edição de informações -->
        <div class="modal" id="editModal" role="dialog">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content modais">
                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h4 class="modal-title text">Editar Item</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <!-- Modal Body -->
                    <div class="modal-body">
                        <!-- Formulário para edição de informações -->
                        <form id="editForm" method="post" action="{{ url_for('edituser.edituser') }}">
                            <div class="form-group">
                                <label for="edit_nome" class="text">Nome:</label>
                                <input type="text" class="form-control" id="edit_nome" name="edit_nome" required>
                            </div>
                            <div class="form-group">
                                <label for="nome" class="text">Cargo:</label>
                                <input type="text" class="form-control" id="edit_cargo" name="edit_cargo" required>
                            </div>
                            <div class="form-group">
                                <label for="edit_role" class="text">Role:</label>
                                <select class="form-control" id="edit_role" name="edit_role" required>
                                    <option value="admin">Administrador</option>
                                    <option value="user">Usuário padrão</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="edit_senha" class="text">Senha:</label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="edit_senha" name="edit_senha" required>
                                    <div class="input-group-append">
                                        <button class="btn btn-primary" type="button" id="toggleEditSenha">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <div class="input-group-append">
                                        <!-- Botão para abrir modal de gerar senha -->
                                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#senhaModal">
                                            <i class="fas fa-key"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Adicione um campo oculto para armazenar o id_pdf -->
                            <input type="hidden" id="edit_id_user" name="edit_id_user" value="edit_id_user"">

                            <!-- Modal Footer -->
                            <div class="modal-footer">
                                <button type="submit" class="btn btn-success">Atualizar</button>
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal para exclusão de informações -->
        <div class="modal" id="deleteModal" role="dialog">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content modais">
                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h4 class="modal-title text">Excluir Item</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <!-- Modal Body -->
                    <div class="modal-body">
                        <form id="deleteForm" method="POST" action="{{ url_for('deleteuser.deleteuser') }}">

                            <p>Deseja excluir o usuário <span id="delete_user_name"></span>?</p>
                            <input id="delete_id_user" type="hidden" name="delete_id_user" value="delete_id_user">
                    
                            <!-- Modal Footer -->
                            <div class="modal-footer">
                                <button type="submit" class="btn btn-danger">Excluir</button>
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer pt-0 px-4">
            <div class="row align-items-center justify-content-lg-between">
                <div class="col-lg-6">
                    <div class="copyright text-center  text-lg-left  text-muted"> © 2024 Made with <a class="font-weight-bold ml-1" href="javascript:" target="_blank">Sirtec</a> &amp;<a class="font-weight-bold ml-1" href="javascript:" target="_blank">VK</a> </div>
                </div>
                <div class="col-lg-6">
                    <ul class="nav nav-footer justify-content-center justify-content-lg-end">
                        <li class="nav-item"> <a href="javascript:;" class="nav-link">Sobre</a> </li>
                        <li class="nav-item"> <a href="javascript:;" class="nav-link">Blog</a> </li>
                        <li class="nav-item"> <a href="javascript:;" class="nav-link">Contate</a> </li>
                    </ul>
                </div>
            </div>
        </footer>
    </div>
    <script src="https://rawcdn.githack.com/Loopple/loopple-public-assets/5cef8f62939eeb089fa26d4c53a49198de421e3d/argon-dashboard/js/vendor/jquery.min.js"></script>
    <script src="https://rawcdn.githack.com/Loopple/loopple-public-assets/5cef8f62939eeb089fa26d4c53a49198de421e3d/argon-dashboard/js/vendor/bootstrap.bundle.min.js"></script>
    <script src="https://rawcdn.githack.com/Loopple/loopple-public-assets/5cef8f62939eeb089fa26d4c53a49198de421e3d/argon-dashboard/js/vendor/js.cookie.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
    <script src="https://rawcdn.githack.com/Loopple/loopple-public-assets/5cef8f62939eeb089fa26d4c53a49198de421e3d/argon-dashboard/js/vendor/chart.extension.js"></script>
    <script src="https://rawcdn.githack.com/Loopple/loopple-public-assets/7bb803d2af2ab6d71d429b0cb459c24a4cd0fbb4/argon-dashboard/js/argon.min.js"></script>
    <script src="{{ url_for('static', filename='admin_users.js') }}"></script>
    <script src="{{ url_for('static', filename='loopple.js') }}"></script>
    
    <script>

        function logout() {
            window.location.href = "{{ url_for('logout.logout') }}";
        }

        // Função para alternar entre a exibição e ocultação da senha ao clicar no botão
        function togglePasswordVisibility(fieldId, buttonId) {
            const campoSenha = document.getElementById(fieldId);
            const tipoCampo = campoSenha.getAttribute("type");
            const button = document.getElementById(buttonId);
            
            if (tipoCampo === "password") {
                campoSenha.setAttribute("type", "text");
                button.innerHTML = '<i class="fas fa-eye-slash"></i>'; // Altera o ícone do botão para um "olho riscado"
            } else {
                campoSenha.setAttribute("type", "password");
                button.innerHTML = '<i class="fas fa-eye"></i>'; // Altera o ícone do botão para um "olho"
            }
        }

        // Adicionar evento de clique para alternar a visibilidade da senha no modal de edição
        document.getElementById("toggleEditSenha").addEventListener("click", function() {
            togglePasswordVisibility("edit_senha", "toggleEditSenha");
        });

        // Adicionar evento de clique para alternar a visibilidade da senha no modal principal
        document.getElementById("toggleSenha").addEventListener("click", function() {
            togglePasswordVisibility("senha", "toggleSenha");
        });
        
    </script>
    
  </body>